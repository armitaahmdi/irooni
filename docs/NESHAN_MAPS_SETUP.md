# راهنمای راه‌اندازی Neshan Maps API

## API‌های مورد نیاز

برای بخش آدرس‌های کاربر، این API‌های نشان را فعال کنید:

1. **Map API** - برای نمایش نقشه
2. **Search API** - برای جستجوی آدرس
3. **Reverse Geocoding API** - برای تبدیل مختصات به آدرس

## مراحل دریافت API Key

### 1. ثبت‌نام در پنل نشان
- به [پنل توسعه‌دهندگان نشان](https://platform.neshan.org/) بروید
- با شماره موبایل یا ایمیل ثبت‌نام کنید
- وارد پنل شوید

### 2. ایجاد پروژه جدید
1. در پنل، روی "پروژه جدید" کلیک کنید
2. نام پروژه را وارد کنید (مثلاً: `irooni-addresses`)
3. نوع پروژه را "وب" انتخاب کنید
4. دامنه‌های مجاز را وارد کنید:
   - `http://localhost:3000`
   - `https://yourdomain.com`

### 3. فعال‌سازی API‌ها
در پنل پروژه، این API‌ها را فعال کنید:

#### الف) Map API
- از لیست API‌ها، "Map API" را پیدا کنید
- روی "فعال‌سازی" کلیک کنید

#### ب) Search API
- "Search API" را پیدا کنید
- روی "فعال‌سازی" کلیک کنید

#### ج) Reverse Geocoding API
- "Reverse Geocoding API" را پیدا کنید
- روی "فعال‌سازی" کلیک کنید

### 4. دریافت API Key
1. در پنل پروژه، به بخش "API Keys" بروید
2. API Key پروژه خود را کپی کنید
3. **این کلید را در جای امن نگه دارید**

### 5. اضافه کردن API Key به پروژه
1. در ریشه پروژه، فایل `.env.local` را باز کنید (یا ایجاد کنید)
2. این خط را اضافه کنید:
   ```
   NEXT_PUBLIC_NESHAN_API_KEY=your_api_key_here
   ```
3. `your_api_key_here` را با کلید API که کپی کردید جایگزین کنید

### 6. راه‌اندازی مجدد سرور
```bash
# اگر سرور در حال اجرا است، آن را متوقف کنید (Ctrl+C)
# سپس دوباره اجرا کنید:
npm run dev
```

## تست کردن
بعد از اضافه کردن API Key:
1. به `/profile` بروید
2. بخش "آدرس‌ها" را انتخاب کنید
3. روی "افزودن آدرس جدید" کلیک کنید
4. باید نقشه نشان نمایش داده شود

## مشکلات رایج

### نقشه نمایش داده نمی‌شود
- بررسی کنید که API Key در `.env.local` درست اضافه شده باشد
- بررسی کنید که Map API فعال شده باشد
- Console مرورگر را بررسی کنید (F12) برای خطاها

### خطای "Invalid API Key"
- بررسی کنید که API Key درست کپی شده باشد
- بررسی کنید که API Key مربوط به پروژه درست باشد

### خطای "API not enabled"
- بررسی کنید که Map API، Search API و Reverse Geocoding API فعال شده باشند
- چند دقیقه صبر کنید تا تغییرات اعمال شوند

### نتایج جستجو نمایش داده نمی‌شود
- بررسی کنید که Search API فعال شده باشد
- بررسی کنید که API Key در header درست ارسال می‌شود

## لینک‌های مفید
- [پنل توسعه‌دهندگان نشان](https://platform.neshan.org/)
- [مستندات Neshan Maps API](https://platform.neshan.org/docs)
- [مستندات OpenLayers](https://openlayers.org/)

## نکات مهم
- نشان یک سرویس ایرانی است و نیازی به VPN ندارد
- API Key را در Git commit نکنید (فایل `.env.local` در `.gitignore` است)
- برای پروژه‌های تجاری، ممکن است نیاز به پلن پولی داشته باشید

